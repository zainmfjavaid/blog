---
import Article from '../components/Article.astro'

interface Article {
    id: number;
    title: string;
    description: string;
    content: string;
    image: string;
    date: string;
}

let articles: Article[] = [];
try {
    const response = await fetch('http://localhost:5000/get-articles');
    if (response.ok) {
        const data = await response.json();
        articles = data.articles.map((article: any) => ({
            id: article[0],
            title: article[1],
            description: article[2],
            content: article[3],
            image: article[4],
            date: article[5]
        }));
    } else {
        console.error('Failed to fetch articles:', response.statusText);
    }
} catch (error) {
    console.error('Error fetching articles:', error);
}
---

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content="Astro description" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/png" href="/favicon.png" />
        <meta name="generator" content={Astro.generator} />
        <title>Zain Blog</title>
    </head>
    <body>
		<div id="content-container">
			<div id="article-container">
				{articles.map((article) => (
					<Article id={article.id} title={article.title} description={article.description} image={article.image} />
				))}
			</div>
		</div>
    </body>
</html>

<style is:global>
    #content-container {
		position: absolute;
		left: 50%;
		transform: translateX(-50%);
		top: 120px;
	}

	#article-container {
		display: flex;
		flex-direction: column;
		row-gap: 10px;
	}
</style>
